Build a TypeScript-based PDF Generator microservice for ERPNext/Frappe integration.
This app should take JSON from ERP, fill values into a pre-mapped PDF template, and return a ready-to-download filled PDF â€” instantly, no UI for users.

ğŸ¯ Goal

ERP calls â†’ /generate endpoint
Sends: template name + data JSON
Gets: filled PDF file

I (admin) will maintain the PDF templates and mapping JSON files manually.
No user editing, no database â€” pure file-based logic.

âš™ï¸ Tech Stack

Node.js (v18+) + TypeScript

Express.js â†’ API routing

pdf-lib â†’ read and write PDFs

pdfjs-dist (optional) â†’ for admin preview

fs-extra â†’ file management

CORS enabled

ğŸ“ Folder Structure
/templates/           â†’ Original PDF templates (e.g. XYZ_Endmill.pdf)
/mappings/            â†’ Mapping JSON files (same filename as template)
/output/              â†’ Generated PDFs (optional, temporary)
/src/
  â”œâ”€â”€ server.ts       â†’ Express app
  â”œâ”€â”€ pdfService.ts   â†’ PDF load + fill + generate logic
  â”œâ”€â”€ types.ts        â†’ Type definitions
/package.json
tsconfig.json

ğŸ§  Mapping JSON Format

Each mapping file defines where to place each field:

{
  "flute_dia": { "x": 120, "y": 440, "size": 10, "align": "left" },
  "price": { "x": 300, "y": 470, "size": 12, "align": "right" },
  "coating": { "x": 180, "y": 500, "size": 10 }
}

ğŸ”¥ API Endpoints
POST /generate

Request body:

{
  "template": "XYZ_Endmill.pdf",
  "data": {
    "flute_dia": "12.5 mm",
    "price": "â‚¹1,250",
    "coating": "TiAlN"
  }
}


Response:

Content-Type: application/pdf

Content-Disposition: attachment; filename="XYZ_Endmill_filled.pdf"

Binary stream of generated PDF

Behavior:

Loads /templates/XYZ_Endmill.pdf

Loads /mappings/XYZ_Endmill.json

Fills text at the defined coordinates using pdf-lib

Auto-shrinks font if text is long

Supports alignment (left, center, right)

Returns generated PDF as a direct download stream

ğŸ§© ERP Integration Example

In Frappe/ERPNext button click handler:

frappe.call({
  method: "POST",
  url: "https://yourdomain.com/generate",
  headers: { "Content-Type": "application/json" },
  data: {
    template: "XYZ_Endmill.pdf",
    data: {
      flute_dia: frm.doc.flute_dia,
      price: frm.doc.price,
      coating: frm.doc.coating
    }
  },
  responseType: "blob",
  success: function (r) {
    const blob = new Blob([r], { type: "application/pdf" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "ToolQuote.pdf";
    link.click();
  }
});


â†’ User clicks â€œDownload Formâ€ â†’ instant PDF download.

ğŸ›  Optional Admin Tool (for you only)

Add /admin route:

Shows PDF viewer (PDF.js)

Click on PDF â†’ define field name â†’ save JSON mapping to /mappings/

Include â€œLoad existing mappingâ€ & â€œPreview filled valuesâ€ options
(Only accessible with static ADMIN_KEY in .env)

ğŸš€ Deployment

Runs on Node 18+ (works on cPanel Node.js Selector or Vercel/Render)

No DB, no extra config.

Just upload folders + server.ts build output to /api/ or /app/

Use npm run build && npm start

ğŸ§¾ Summary

/generate API: Receives JSON â†’ returns filled PDF

/mappings/*.json: define coordinates

Admin-only /admin to visually adjust mappings (optional)

Fully TypeScript, async/await, clean code

Works with ERP directly â€” one click â†’ instant download

Goal: A minimal, fast, file-based TypeScript app for dynamic PDF generation from ERPNext/Frappe via API â€” with optional visual field mapping for admin.

IGNORE THE FOLDER STRUCUTRE ETC. Just understand the problem and make something u can make just make sure it works also make sure that i can adjust positioning of dynamic values that u will get via JSON from a pdf / dxf format so that it will work always